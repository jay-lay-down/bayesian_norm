# bayesian_norm
정성+정량 데이터를 결합한 형용사 평가

# 주의사항
📍이 저장소의 데이터셋은 실제 브랜드 조사 데이터가 아님. 연구/데모 목적을 위해 임의 생성한 샘플 데이터\
📍Bayesian_norm.py에는 간단한 로직만 수록되어 있음

# 분석방법
📍 온라인 리뷰 크롤링 후, Dictionary(기능/형용사)에 맞게 토큰화 및 count한 결과를 사전믿음으로 간주한 후, 향후 기능별 브랜드 이미지 조사 데이터(임의생성)를 likelihood로 정의하고 hierarchical bayesian 모델 학습\
📍 Bayesian 결과와 normal disbribution 대조

# 주 사용 라이브러리
📍PyMC(베이지안 추정), NumPy / Pandas (연산/집계), SciPy(MLE 최적화) / excel VBA(대시보드)

# 사용 데이터
📍 브랜드별 특정 품목의 리뷰 크롤링 결과 / Dictionary(텍스트마이닝 시 활용) / 임의로 생성한 기능x브랜드 이미지 조사 데이터

# 주요 분석단계
이 스크립트는 데이터 처리, 베이즈 모델링, 결과 생성, 실행 및 패키징의 4단계로 구성됨.

### ⚙️ 데이터 준비 및 전처리
- **📄 데이터 로딩 (`read_excel_robust`)**: `.xlsx`, `.xls`, `.xlsb`, `.csv` 등 다양한 형식의 파일을 읽음. 파일 로딩 실패 시 다른 엔진으로 재시도함.
- **🔎 컬럼 탐지 (`find_col`)**: '브랜드'나 'brand'처럼 표기가 다른 컬럼명을 미리 정의된 후보군을 바탕으로 찾아냄.
- **🔄 데이터 구조 변환**: 'Wide' 형식(형용사가 각 컬럼)의 데이터를 분석에 필요한 'Long' 형식(데이터가 행으로 긴 형태)으로 자동 변환함.
- **🔧 분석 범위 설정 옵션**:\
  - `adj_limit`: 분석할 형용사 수를 빈도수 기준 상위 N개로 제한해 계산 속도를 조절함.
  - `adj_whitelist`: 지정한 형용사 리스트만 분석에 포함시킴.

***

### 📊 계층적 베이즈 모델

PyMC 라이브러리를 사용해 통계 모델을 구축함. 모델의 수식은 아래와 같음.

$$
\text{Score}_{i} \sim \text{StudentT}(\nu, \mu_i, \sigma_{\text{obs}})
$$
$$
\mu_i = \mu_0 + \beta_{\text{brand}[i]} + \beta_{\text{attr}[i]} + \beta_{\text{adj}[i]} + (\text{Interaction Terms})
$$

- **모델 구조**: 브랜드, 속성, 형용사가 점수에 미치는 주 효과와 상호작용 효과를 모델링함.
- **계층적 구조**: 각 브랜드, 속성, 형용사 효과($\beta$)가 개별적이면서도 공통의 상위 분포를 따른다고 가정함. 이 구조는 데이터가 적은 항목의 추정치를 안정화하는 데 도움을 줌 ("정보 빌려오기" 효과).\
- **상호작용 효과**: `include_bxj` (브랜드 x 형용사) 같은 옵션을 통해 특정 조합의 효과를 모델에 추가하거나 제외할 수 있음.
- **Student-T 분포**: 일반적인 정규분포 대신 Student-T 분포를 사용하여 이상치(outlier)에 덜 민감한 모델을 만듦.

***

### 📑 결과 테이블 생성
모델링으로 얻은 MCMC 샘플(후방 분포)을 2가지 형태의 요약 테이블로 가공함.
- `regTbl`: 각 '그룹(브랜드/전체) - 형용사' 조합의 **평균 점수(`mean`)와 표준편차(`sd`)를 정리**한 테이블임.
- `bayesTbl`: 다른 베이지안 시스템에 활용할 수 있도록 **후방 분포의 파라미터(`post_mu`, `post_k` 등)를 정리**한 테이블임.

***

### 🚀 실행 및 패키징
- **`run_all` 함수**: 데이터 로딩부터 결과 저장까지 모든 과정을 순차적으로 실행함.
- **FAST 프리셋**: 샘플링 횟수, 상호작용 포함 여부 등을 조절하여 빠른 실행을 위한 설정 예시를 제공함.
- **결과물**: 분석 결과(Excel)를 타임스탬프가 포함된 ZIP 파일로 압축하여 저장함.

## 대시보드 구축단계
📍VBA Chart 구축

# 한계/보완점
📍텍스트마이닝 시, Dictionary finetuning을 사람이 해야 해서 비효율적\
📍보완방법 고려: Transformer 등 LLM 학습을 통한 Dictionary 분류 자동화 고려

# 대시보드 불러오기

# 예시이미지
